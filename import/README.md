# Импорт данных из Excel

Этот раздел описывает подготовку и загрузку Excel-файлов с водителями и транспортом.

## Требования к файлу
- Формат: `.xlsx`, один лист `Drivers`.
- Первая строка содержит заголовки колонок:
  - `full_name` — ФИО водителя.
  - `phone` — телефон в формате `+7XXXXXXXXXX`.
  - `email` — корпоративная почта (опционально).
  - `vehicle_plate` — госномер без пробелов.
  - `vehicle_model` — марка и модель.
  - `license_expiry` — дата истечения водительского удостоверения (ISO `YYYY-MM-DD`).
  - `medical_expiry` — дата окончания медсправки (ISO `YYYY-MM-DD`).
  - `insurance_expiry` — дата окончания страховки (ISO `YYYY-MM-DD`).

## Валидация
1. Проверяем наличие всех обязательных колонок (`full_name`, `phone`, `vehicle_plate`, `license_expiry`).
2. Нормализуем телефон и проверяем формат через регулярное выражение `^\+7\d{10}$`.
3. Даты валидируем и конвертируем в UTC, значения из прошлого помечаем как `expired`.
4. Дубликаты по `vehicle_plate` и `full_name + phone` блокируются, требуется ручное разрешение.
5. При успешной проверке формируем JSON-пакет для API `POST /import/drivers` (будет описан отдельно).

## Хранение исходников
- Исходные Excel-файлы складываем в репозитории в каталог `import/source/` (не версионируется, добавим через `.gitignore`).
- Для каждой загрузки создаем подпапку `YYYYMMDD-description` с оригиналом и логом валидации.
- После импорта файл и лог загружаются в хранилище аудит-трекинга (S3/Drive).
